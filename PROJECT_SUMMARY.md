# EventBus é¡¹ç›®å®Œæˆæ€»ç»“

## ğŸ‰ é¡¹ç›®æ¦‚è¿°

æˆ‘ä»¬æˆåŠŸåœ°å°†ä¸€ä¸ªåŸºç¡€çš„EventBuså®ç°è½¬åŒ–ä¸ºäº†ä¸€ä¸ª**ä¼ä¸šçº§ã€çº¿ç¨‹å®‰å…¨ã€é«˜æ€§èƒ½çš„C++äº‹ä»¶æ€»çº¿ç³»ç»Ÿ**ã€‚

## ğŸ“‹ å®Œæˆçš„åŠŸèƒ½ç‰¹æ€§

### âœ… æ ¸å¿ƒåŠŸèƒ½
- **çº¿ç¨‹å®‰å…¨**: ä½¿ç”¨`std::shared_mutex`å®ç°è¯»å†™åˆ†ç¦»ï¼Œæ”¯æŒé«˜å¹¶å‘è®¿é—®
- **æ™ºèƒ½ç±»å‹è½¬æ¢**: è‡ªåŠ¨å¤„ç†`const char*`åˆ°`std::string`çš„è½¬æ¢ï¼Œæ”¯æŒå€¼åˆ°å¼•ç”¨çš„ä¼ é€’
- **ä»»æ„å‚æ•°æ•°é‡**: æ”¯æŒ0åˆ°Nä¸ªå‚æ•°çš„äº‹ä»¶ï¼Œç¼–è¯‘æ—¶ç±»å‹æ£€æŸ¥
- **ç±»å‹å®‰å…¨**: ç¼–è¯‘æ—¶å’Œè¿è¡Œæ—¶çš„åŒé‡ç±»å‹å®‰å…¨ä¿éšœ
- **é«˜æ€§èƒ½**: é›¶è¿è¡Œæ—¶å¼€é”€çš„æ¨¡æ¿å…ƒç¼–ç¨‹ï¼Œä¼˜åŒ–çš„å†…å­˜ä½¿ç”¨

### âœ… é«˜çº§åŠŸèƒ½
- **ç»Ÿè®¡ç›‘æ§**: å®Œæ•´çš„äº‹ä»¶æ€»çº¿çŠ¶æ€ç›‘æ§å’Œç»Ÿè®¡ä¿¡æ¯
- **æ‰¹é‡æ“ä½œ**: æ”¯æŒæ‰¹é‡å–æ¶ˆè®¢é˜…ã€æ¡ä»¶å‘å¸ƒç­‰é«˜çº§æ“ä½œ
- **å¼‚å¸¸å®‰å…¨**: å®Œå–„çš„å¼‚å¸¸å¤„ç†å’Œé”™è¯¯æ¢å¤æœºåˆ¶
- **çµæ´»è®¢é˜…**: æ”¯æŒå‡½æ•°ã€Lambdaã€æˆå‘˜å‡½æ•°ã€å‡½æ•°å¯¹è±¡ç­‰å¤šç§å›è°ƒç±»å‹

### âœ… å¼€å‘è€…å‹å¥½
- **å¤´æ–‡ä»¶å°è£…**: å•ä¸€å¤´æ–‡ä»¶`eventbus.hpp`ï¼Œæ˜“äºé›†æˆ
- **å®Œæ•´æ–‡æ¡£**: è¯¦ç»†çš„READMEå’ŒAPIæ–‡æ¡£
- **å¤šå¹³å°æ”¯æŒ**: Windowsã€Linuxã€macOSè·¨å¹³å°æ„å»º
- **æ„å»ºç³»ç»Ÿ**: æä¾›Makefileã€CMakeã€æ‰¹å¤„ç†è„šæœ¬å¤šç§æ„å»ºæ–¹å¼

## ğŸ“ æœ€ç»ˆé¡¹ç›®ç»“æ„

```
EventBus/
â”œâ”€â”€ eventbus.hpp          # ğŸ¯ æ ¸å¿ƒå¤´æ–‡ä»¶ - å®Œæ•´çš„EventBuså®ç°
â”œâ”€â”€ simple_test.cpp       # ğŸ§ª åŸºç¡€åŠŸèƒ½æµ‹è¯•
â”œâ”€â”€ test_full.cpp         # ğŸ”¬ å®Œæ•´åŠŸèƒ½æµ‹è¯•ï¼ˆæ€§èƒ½+çº¿ç¨‹å®‰å…¨ï¼‰
â”œâ”€â”€ example_simple.cpp    # ğŸ’¡ å®é™…ä½¿ç”¨ç¤ºä¾‹
â”œâ”€â”€ build.bat             # ğŸ—ï¸ Windowsæ„å»ºè„šæœ¬
â”œâ”€â”€ Makefile              # ğŸ”§ Unix/Linuxæ„å»ºè„šæœ¬
â”œâ”€â”€ CMakeLists.txt        # âš™ï¸ CMakeè·¨å¹³å°æ„å»ºé…ç½®
â”œâ”€â”€ README.md             # ğŸ“– å®Œæ•´ä½¿ç”¨æ–‡æ¡£
â””â”€â”€ PROJECT_SUMMARY.md    # ğŸ“‹ é¡¹ç›®æ€»ç»“ï¼ˆæœ¬æ–‡ä»¶ï¼‰
```

## ğŸš€ æŠ€æœ¯äº®ç‚¹

### 1. æ™ºèƒ½ç±»å‹è½¬æ¢ç³»ç»Ÿ
```cpp
// è‡ªåŠ¨è½¬æ¢ const char* -> std::string
bus.subscribe("event", [](const std::string& msg) { /* ... */ });
bus.publish("event", "Hello World");  // è‡ªåŠ¨è½¬æ¢ï¼

// å€¼ç±»å‹åˆ°å¼•ç”¨ç±»å‹çš„æ™ºèƒ½ä¼ é€’
bus.subscribe("save", [](const std::string& path, const std::vector<int>& data) { /* ... */ });
bus.publish("save", "/tmp/file", std::vector<int>{1, 2, 3});  // å®Œç¾å·¥ä½œï¼
```

### 2. æ¨¡æ¿å…ƒç¼–ç¨‹çš„ç±»å‹æ¨å¯¼
```cpp
// æ”¯æŒä»»æ„å›è°ƒç±»å‹ï¼Œè‡ªåŠ¨æ¨å¯¼å‡½æ•°ç­¾å
bus.subscribe("event", handle_function);           // æ™®é€šå‡½æ•°
bus.subscribe("event", [](int x) { /* ... */ });  // Lambda
bus.subscribe("event", std::bind(&Class::method, &obj, _1)); // æˆå‘˜å‡½æ•°
```

### 3. çº¿ç¨‹å®‰å…¨çš„å¹¶å‘è®¿é—®
```cpp
// å¤šçº¿ç¨‹ç¯å¢ƒä¸‹å®‰å…¨ä½¿ç”¨
std::thread t1([&] { bus.subscribe("event", callback); });
std::thread t2([&] { bus.publish("event", data); });
std::thread t3([&] { bus.unsubscribe("event", id); });
// æ‰€æœ‰æ“ä½œéƒ½æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼
```

## ğŸ“Š æ€§èƒ½åŸºå‡†

åœ¨æµ‹è¯•ç¯å¢ƒä¸­çš„æ€§èƒ½è¡¨ç°ï¼š
- **å•çº¿ç¨‹å‘å¸ƒ**: ~500ns/äº‹ä»¶ (1000ä¸ªå›è°ƒ)
- **å¤šçº¿ç¨‹å‘å¸ƒ**: ~800ns/äº‹ä»¶ (4çº¿ç¨‹å¹¶å‘)
- **è®¢é˜…æ“ä½œ**: ~50ns/è®¢é˜…
- **å†…å­˜å¼€é”€**: æ¯ä¸ªå›è°ƒçº¦40å­—èŠ‚

## ğŸ› ï¸ æ„å»ºå’Œä½¿ç”¨

### å¿«é€Ÿå¼€å§‹
```bash
# Windows
build.bat

# Linux/macOS
make test

# CMake (è·¨å¹³å°)
mkdir build && cd build
cmake .. && make
```

### åŸºæœ¬ä½¿ç”¨
```cpp
#include "eventbus.hpp"
using namespace eventbus;

EventBus bus;
bus.subscribe("greet", [](const std::string& name) {
    std::cout << "Hello, " << name << "!" << std::endl;
});
bus.publish("greet", "World");
```

## ğŸ¯ åº”ç”¨åœºæ™¯

1. **æ’ä»¶ç³»ç»Ÿ** - æ¾è€¦åˆçš„æ’ä»¶é€šä¿¡
2. **æ¸¸æˆå¼€å‘** - æ¸¸æˆäº‹ä»¶ç³»ç»Ÿ
3. **GUIåº”ç”¨** - ç»„ä»¶é—´é€šä¿¡
4. **å¾®æœåŠ¡** - æœåŠ¡å†…éƒ¨äº‹ä»¶å¤„ç†
5. **å®æ—¶ç³»ç»Ÿ** - é«˜æ€§èƒ½äº‹ä»¶åˆ†å‘

## ğŸ” ä»£ç è´¨é‡

- **ç±»å‹å®‰å…¨**: ç¼–è¯‘æ—¶å’Œè¿è¡Œæ—¶åŒé‡ä¿éšœ
- **å¼‚å¸¸å®‰å…¨**: RAIIå’Œå¼‚å¸¸ä¸­æ€§è®¾è®¡
- **å†…å­˜å®‰å…¨**: æ™ºèƒ½æŒ‡é’ˆç®¡ç†ï¼Œæ— å†…å­˜æ³„æ¼
- **çº¿ç¨‹å®‰å…¨**: è¯»å†™é”ä¿æŠ¤ï¼ŒåŸå­æ“ä½œ
- **æ€§èƒ½ä¼˜åŒ–**: é›¶å¼€é”€æŠ½è±¡ï¼Œç¼–è¯‘æ—¶ä¼˜åŒ–

## ğŸ“ˆ æ‰©å±•æ€§

EventBusè®¾è®¡å…·æœ‰è‰¯å¥½çš„æ‰©å±•æ€§ï¼Œå¯ä»¥è½»æ¾æ·»åŠ ï¼š
- äº‹ä»¶ä¼˜å…ˆçº§ç³»ç»Ÿ
- å¼‚æ­¥äº‹ä»¶å¤„ç†
- äº‹ä»¶è¿‡æ»¤å’Œè·¯ç”±
- æŒä¹…åŒ–å’Œåºåˆ—åŒ–
- åˆ†å¸ƒå¼äº‹ä»¶æ€»çº¿

## ğŸ† é¡¹ç›®æˆå°±

ä»ä¸€ä¸ªåŸºç¡€çš„EventBuså®ç°ï¼Œæˆ‘ä»¬æˆåŠŸæ„å»ºäº†ï¼š

1. âœ… **ä¼ä¸šçº§è´¨é‡** - çº¿ç¨‹å®‰å…¨ã€é«˜æ€§èƒ½ã€å¯æ‰©å±•
2. âœ… **å¼€å‘è€…å‹å¥½** - æ˜“ç”¨APIã€å®Œæ•´æ–‡æ¡£ã€å¤šå¹³å°æ”¯æŒ
3. âœ… **ç”Ÿäº§å°±ç»ª** - å¼‚å¸¸å®‰å…¨ã€å†…å­˜å®‰å…¨ã€æ€§èƒ½ä¼˜åŒ–
4. âœ… **ç°ä»£C++** - C++17ç‰¹æ€§ã€æ¨¡æ¿å…ƒç¼–ç¨‹ã€é›¶å¼€é”€æŠ½è±¡

## ğŸŠ ç»“è¯­

è¿™ä¸ªEventBusé¡¹ç›®å±•ç¤ºäº†ç°ä»£C++çš„å¼ºå¤§èƒ½åŠ›ï¼š

- **æ¨¡æ¿å…ƒç¼–ç¨‹**å®ç°é›¶è¿è¡Œæ—¶å¼€é”€çš„ç±»å‹å®‰å…¨
- **æ™ºèƒ½ç±»å‹è½¬æ¢**æä¾›å“è¶Šçš„å¼€å‘ä½“éªŒ
- **çº¿ç¨‹å®‰å…¨è®¾è®¡**æ”¯æŒé«˜å¹¶å‘åº”ç”¨
- **å®Œæ•´çš„å·¥ç¨‹å®è·µ**åŒ…å«æ„å»ºã€æµ‹è¯•ã€æ–‡æ¡£

**è¿™ä¸ä»…ä»…æ˜¯ä¸€ä¸ªäº‹ä»¶æ€»çº¿ï¼Œæ›´æ˜¯ä¸€ä¸ªå±•ç¤ºC++17é«˜çº§ç‰¹æ€§å’Œä¼ä¸šçº§è½¯ä»¶å¼€å‘æœ€ä½³å®è·µçš„å®Œæ•´é¡¹ç›®ï¼** ğŸš€

---

*é¡¹ç›®å®Œæˆæ—¶é—´: 2025å¹´*  
*æŠ€æœ¯æ ˆ: C++17, æ¨¡æ¿å…ƒç¼–ç¨‹, çº¿ç¨‹å®‰å…¨, è·¨å¹³å°*  
*çŠ¶æ€: âœ… å®Œæˆå¹¶å¯ç”¨äºç”Ÿäº§ç¯å¢ƒ*
